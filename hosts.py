inventory = dict()
inventory['node01']    = {  'ansible_host': '10.100.0.11', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node02']    = {  'ansible_host': '10.100.0.12', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node03']    = {  'ansible_host': '10.100.0.13', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node04']    = {  'ansible_host': '10.100.0.14', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node05']    = {  'ansible_host': '10.100.0.15', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node06']    = {  'ansible_host': '10.100.0.16', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node07']    = {  'ansible_host': '10.100.0.17', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node08']    = {  'ansible_host': '10.100.0.18', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node09']    = {  'ansible_host': '10.100.0.19', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node10']    = {  'ansible_host': '10.100.0.20', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node11']    = {  'ansible_host': '10.100.0.21', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node20']    = {  'ansible_host': '10.100.0.30', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node21']    = {  'ansible_host': '10.100.0.31', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node22']    = {  'ansible_host': '10.100.0.32', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node23']    = {  'ansible_host': '10.100.0.33', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node24']    = {  'ansible_host': '10.100.0.34', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node25']    = {  'ansible_host': '10.100.0.35', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node26']    = {  'ansible_host': '10.100.0.36', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node27']    = {  'ansible_host': '10.100.0.37', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node28']    = {  'ansible_host': '10.100.0.38', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node29']    = {  'ansible_host': '10.100.0.39', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node30']    = {  'ansible_host': '10.100.0.40', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node31']    = {  'ansible_host': '10.100.0.41', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node32']    = {  'ansible_host': '10.100.0.42', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node33']    = {  'ansible_host': '10.100.0.43', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['node35']    = {  'ansible_host': '10.100.0.45', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['angainor']  = {  'ansible_host': '146.193.41.56', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['cosmos']    = {  'ansible_host': '146.193.41.55', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['ngstorage'] = {  'ansible_host': '146.193.41.54', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['intel14v1'] = {  'ansible_host': '146.193.41.45', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['intel14v2'] = {  'ansible_host': '146.193.41.51', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['nvram']     = {  'ansible_host': '146.193.41.52', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['saturn1']   = {  'ansible_host': '146.193.41.71', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}
inventory['saturn2']   = {  'ansible_host': '146.193.41.77', 'ansible_user': 'jfloff', 'ansible_ssh_private_key_file': '~/.ssh/id_rsa_inesc_cluster_jfloff'}


def build_inventory(topology):
    # define node participants initialization order
    init_order = 0


    inventory[topology['manager']]['init_order'] = init_order
    inventory[topology['manager']]['replica_id'] = init_order
    init_order += 1   

    inventory[topology['swarm_manager']]['init_order'] = init_order
    inventory[topology['swarm_manager']]['replica_id'] = init_order
    init_order += 1   

    inventory[topology['prometheus_stack']]['init_order'] = init_order
    inventory[topology['prometheus_stack']]['replica_id'] = init_order
    init_order += 1   

    inventory[topology['mqtt']]['init_order'] = init_order
    inventory[topology['mqtt']]['replica_id'] = init_order
    init_order += 1   

    for ca in  topology['cas']:
        inventory[ca]['init_order'] = init_order
        inventory[ca]['replica_id'] = init_order
        init_order += 1   

    for orderer in topology['orderers']:
        inventory[orderer]['init_order'] = init_order
        inventory[orderer]['replica_id'] = init_order
        init_order += 1
    
    # shift loader/clients to let enough time for servers to initialize
    init_order += 1    
    for client in topology['caliper']:
        # loader is the first client
        inventory[client]['init_order'] = init_order 
        inventory[client]['replica_id'] = init_order 
        init_order += 1

    # pprint(inventory)
    # exit()

    # build inventory line with all variables
    def inventory_line(key, inv):
        return f"{key}  oc={inv[key]['oc']} node_id={inv[key]['node_id']} replica_id={inv[key]['replica_id']} init_order={inv[key]['init_order']} alt_nodename={inv[key]['alt_nodename']} ansible_host={inv[key]['ansible_host']} ansible_user={inv[key]['ansible_user']} ansible_ssh_private_key_file={inv[key]['ansible_ssh_private_key_file']}                "
    
    # create the inventory of all nodes:
    all_nodes = list()
    all_nodes.append(inventory_line(topology['manager'],inventory))
    all_nodes.append(inventory_line(topology['mqtt'],inventory))
    all_nodes.append(inventory_line(topology['swarm_manager'],inventory))
    all_nodes.append(inventory_line(topology['prometheus_stack'],inventory))
    all_nodes.append(inventory_line(topology['webserver'],inventory))

    # specific for topology   
    for ca in topology['cas']:
        all_nodes.append(inventory_line(ca,inventory))
    for orderer in topology['orderers']:
        all_nodes.append(inventory_line(orderer,inventory)) 
    for peer in topology['peers']:
        all_nodes.append(inventory_line(peer,inventory)) 
    for client in topology['caliper']:
        all_nodes.append(inventory_line(client,inventory)) 


    content = []
    content.append("[nodes]")
    content.extend(sorted(list(set(all_nodes))))
    content.append("")